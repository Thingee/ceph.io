---
title: "Introducing ceph-nano"
date: "2017-11-28"
author: "admin"
tags: 
  - "planet"
---

![Introducing ceph-nano](http://sebastien-han.fr/blog/images/introducing-ceph-nano.gif =450x450)

I’ve recently started a small project that aims to help developers working with the S3 API. The program is called `cn` for Ceph Nano, is available on [github](https://github.com/ceph/cn) let me give you a tour of what it does. I initially presented the program during my talk at the last OpenStack summit in Sydney. Originally, I wrote a quick prototype in Bash, then moved to Go.

## I. Ceph Nano

cn is a little program written in Go that helps you interacting with S3 by providing a REST S3 compatible gateway. This is brought by the power of Ceph and Containers. cn also comes with a set of commands to work with the S3 gateway.

Available calls are:

<table><tbody><tr><td class="code"><pre><span class="line">$  ./cn s3 -h</span><br><span class="line">Interact with S3 object server</span><br><span class="line"></span><br><span class="line">Usage:</span><br><span class="line">  cn s3 [<span class="built_in">command</span>]</span><br><span class="line"></span><br><span class="line">Available Commands:</span><br><span class="line">  mb          Make bucket</span><br><span class="line">  rb          Remove bucket</span><br><span class="line">  ls          List objects or buckets</span><br><span class="line">  la          List all object <span class="keyword">in</span> all buckets</span><br><span class="line">  put         Put file into bucket</span><br><span class="line">  get         Get file into bucket</span><br><span class="line">  del         Delete bucket</span><br><span class="line">  du          Disk usage by buckets</span><br><span class="line">  info        Get various information about Buckets or Files</span><br><span class="line">  cp          Copy object</span><br><span class="line">  mv          Move object</span><br><span class="line">  sync        Synchronize a directory tree to S3</span><br><span class="line"></span><br><span class="line">Flags:</span><br><span class="line">  -h, --help   <span class="built_in">help</span> <span class="keyword">for</span> s3</span><br><span class="line"></span><br><span class="line">Use <span class="string">"cn s3 [command] --help"</span> <span class="keyword">for</span> more information about a command.</span><br></pre></td></tr></tbody></table>

## II. Installation

cn relies on Docker so it must be installed on your machine. If you’re not running a Linux workstation you can install [Docker for Mac](https://docs.docker.com/docker-for-mac/) or [Windows](https://docs.docker.com/docker-for-windows/).

Once Docker is installed you’re ready to start. Open your terminal and download the cn binary, example below is for Linux, for OSX use `cn-v1.0.0-darwin-amd64`.

<table><tbody><tr><td class="code"><pre><span class="line">$ curl -L https://github.com/ceph/cn/releases/download/v1.0.0/cn-v1.0.0-linux-x86 -o cn</span><br><span class="line">$ chmod +x cn</span><br><span class="line">$ ./cn</span><br><span class="line">Ceph Nano - One step S3 in container with Ceph.</span><br><span class="line"></span><br><span class="line">Usage:</span><br><span class="line">  cn [command]</span><br><span class="line"></span><br><span class="line">Available Commands:</span><br><span class="line">  <span class="keyword">start</span>       <span class="keyword">Start</span> <span class="keyword">object</span> <span class="keyword">storage</span> <span class="keyword">server</span></span><br><span class="line">  <span class="keyword">stop</span>        <span class="keyword">Stop</span> <span class="keyword">object</span> <span class="keyword">storage</span> <span class="keyword">server</span></span><br><span class="line">  <span class="keyword">status</span>      Stat <span class="keyword">object</span> <span class="keyword">storage</span> <span class="keyword">server</span></span><br><span class="line">  <span class="keyword">purge</span>       <span class="keyword">Purge</span> <span class="keyword">object</span> <span class="keyword">storage</span> server. DANGEROUS!</span><br><span class="line">  <span class="keyword">logs</span>        Print <span class="keyword">object</span> <span class="keyword">storage</span> <span class="keyword">server</span> <span class="keyword">logs</span></span><br><span class="line">  restart     Restart <span class="keyword">object</span> <span class="keyword">storage</span> <span class="keyword">server</span></span><br><span class="line">  s3          Interact <span class="keyword">with</span> S3 <span class="keyword">object</span> <span class="keyword">server</span></span><br><span class="line">  <span class="keyword">update</span>      <span class="keyword">Update</span> the <span class="keyword">container</span> image</span><br><span class="line">  <span class="keyword">version</span>     Print the <span class="keyword">version</span> <span class="built_in">number</span> <span class="keyword">of</span> Ceph Nano</span><br><span class="line">  <span class="keyword">help</span>        <span class="keyword">Help</span> about <span class="keyword">any</span> command</span><br><span class="line"></span><br><span class="line">Flags:</span><br><span class="line">  -h, <span class="comment">--help   help for cn</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Use</span> <span class="string">"cn [command] --help"</span> <span class="keyword">for</span> more information about a command.</span><br></pre></td></tr></tbody></table>

## III. Get started

Start the program with a working directory `/tmp`, the initial start might take a few minutes since we need to download the container image:

<table><tbody><tr><td class="code"><pre><span class="line">$ ./<span class="literal">cn</span> start <span class="attr">-d</span> /tmp</span><br><span class="line">Running ceph<span class="attr">-nano</span><span class="attr">...</span></span><br><span class="line">The container image is <span class="keyword">not</span> present, pulling it.</span><br><span class="line">This operation can <span class="keyword">take</span> a few minutes<span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span><span class="attr">...</span>.</span><br><span class="line"></span><br><span class="line">HEALTH_OK is the Ceph status</span><br><span class="line">S3 object server address is: http:<span class="comment">//192.168.0.10:8000</span></span><br><span class="line">S3 user is: nano</span><br><span class="line">S3 access key is: E7MCNPWED4BIV21J1BZG</span><br><span class="line">S3 secret key is: JG5wmxw2bGOxXLc7v6NQ2yg50atPCu3Nxe4XXvEf</span><br><span class="line">Your working directory is: /tmp</span><br></pre></td></tr></tbody></table>

## IV. Work with this CLI

Your first S3 bucket!

<table><tbody><tr><td class="code"><pre><span class="line">$ ./<span class="meta">cn</span> <span class="built_in">s3</span> mb my-<span class="keyword">buc</span><br><span class="line"></span><span class="keyword">Bucket </span><span class="string">'s3://my-buc/'</span> created</span><br><span class="line"></span><br><span class="line">$ ./<span class="meta">cn</span> <span class="built_in">s3</span> put /etc/passwd my-<span class="keyword">buc</span><br><span class="line"></span><span class="symbol">upload</span>: <span class="string">'/tmp/passwd'</span> -&gt; <span class="string">'s3://my-buc/passwd'</span>  [<span class="number">1</span> of <span class="number">1</span>]</span><br><span class="line"> <span class="number">5925</span> of <span class="number">5925</span>   <span class="number">100</span>% in    <span class="number">1</span>s     <span class="number">4</span>.<span class="number">57</span> kB/s  done</span><br></pre></td></tr></tbody></table>

  

> To all the designers out there, if someone wants to work on a little logo for ceph-nano that’ll be really awesome. I guess that when it comes to design I’m only good with diagram, for the rest I just suck :).

Source: Sebastian Han ([Introducing ceph-nano](https://sebastien-han.fr/blog/2017/11/28/Introducing-ceph-nano/))
